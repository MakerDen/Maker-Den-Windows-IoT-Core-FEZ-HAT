char cmd = e.Item.Length > 0 ? e.Item.ToUpper()[0] : ' ';  // get command character sent from IoT Hub

switch (cmd)
{
    case 'R':
        publishColor = FEZHAT.Color.Red;
        break;
    case 'G':
        publishColor = FEZHAT.Color.Green;
        break;
    case 'B':
        publishColor = FEZHAT.Color.Blue;
        break;
    case 'Y':
        publishColor = FEZHAT.Color.Yellow;
        break;
    case 'M':
        publishColor = FEZHAT.Color.Magneta;
        break;
    default:
        System.Diagnostics.Debug.WriteLine("Unrecognized command: {0}", e.Item);
        break;
}

hat.D3.Color = publishColor;